<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<link rel="stylesheet" href="css/index.css">
		<title>Cloud Services Analyzator</title>
		<script>
		
			function delete_html_table_content(){
				while(document.getElementById("myTable").rows.length > 1){
					document.getElementById("myTable").deleteRow(1);
				}
				return false;
			}
			
			function wizard_func(){
				document.getElementById("wizard_form").style.visibility="visible";
				return false;
			}
			
			function export_func(){
				var data = new FormData();
				data.append("export",document.getElementById("export").name);
				data.append("wizard","notactive");
				data.append("import","notactive");


				var xhr = new XMLHttpRequest();
				xhr.open("POST","./php/index.php");
				xhr.onload = function(){
					console.log(this.response);
				};
				
				xhr.send(data);
				
				return false;
			}
			function get_data_from_database($action){
				delete_html_table_content();
				var data = new FormData();
				
					
				if($action == "wizard")data.append("wizard",document.getElementById("wizard").name);
				else data.append("wizard","notactive");
				
				if($action == "import")data.append("import",document.getElementById("import").name);
				else data.append("import","notactive");
				
				data.append("export","notactive");
			
				data.append("min_price_per_day",document.getElementById("min_price_per_day").value);
				data.append("max_price_per_day",document.getElementById("max_price_per_day").value);
				data.append("min_memory",document.getElementById("min_memory").value);
				data.append("max_memory",document.getElementById("max_memory").value);
				data.append("regions_names",document.getElementById("regions_names").value);
				
				
				var xhr = new XMLHttpRequest();
				xhr.open("POST","./php/index.php");
				xhr.onload = function(){
				
					
					
				     var result = xhr.responseText;
				     console.log(result);
				     var lines=result.split('\n');
				     let table = document.getElementById("myTable");

   				     for(let i=0; i<(lines.length-1)/11	 ;i++){

				      // Create a row using the inserRow() method and
				      // specify the index where you want to add the row
				      let row = table.insertRow(-1); // We are adding at the end

				      // Create table cells
				      let c1 = row.insertCell(0);
				      let c2 = row.insertCell(1);
				      let c3 = row.insertCell(2);
				      let c4 = row.insertCell(3);
				      let c5 = row.insertCell(4);
				      let c6 = row.insertCell(5);
				      let c7 = row.insertCell(6);
				      let c8 = row.insertCell(7);
				      let c9 = row.insertCell(8)
				      let c10 = row.insertCell(9)
				      let c11 = row.insertCell(10)

				      // Add data to c1 and c2
				      c1.innerText = lines[i * 11];
				      c2.innerText = lines[i*11 + 1];
				      c3.innerText = lines[i*11 + 2];
				      c4.innerText = lines[i*11 + 3];
				      c5.innerText = lines[i*11 + 4];
				      c6.innerText = lines[i*11 + 5];
				      c7.innerText = lines[i*11 + 6];
				      c8.innerText = lines[i*11 + 7];
				      c9.innerText = lines[i*11 + 8];
				      c10.innerText = lines[i*11 + 9];
				      c11.innerText = lines[i*11 + 10];
				      
				      
				      if(parseFloat(c10.innerText) < 0.00) c10.style.color="green";
				      else if(parseFloat(c10.innerText) > 0.00) c10.style.color="red";
				      
				      if(parseFloat(c11.innerText) < 0.00) c11.style.color="green";
				      else if(parseFloat(c11.innerText) > 0.00) c11.style.color="red";
				      
				      c10.innerText = `${lines[i*11 + 9]}%`;
				      c11.innerText = `${lines[i*11 + 10]}%`;
				      
			             }
				}
				xhr.send(data);
				
				return false;
			}
			
			function display_news(){
				var data = new FormData();
				
					
				
				data.append("wizard","notactive");
				data.append("import","notactive");
				data.append("export","notactive");
				data.append("news","news_btn")
				
				
				var xhr = new XMLHttpRequest();
				xhr.open("POST","./php/index.php");
				xhr.onload = function(){
				     var result = xhr.responseText;
				     console.log(result);

					var lines=result.split('\n');

					for(let i=0; i<(lines.length-1) ;i++){
					var tag = document.createElement("p");
					var text = document.createTextNode(lines.at(i));
					tag.appendChild(text);
					var element = document.getElementById("news");
					element.appendChild(tag);

					}
				}
				xhr.send(data);
				
				return false;
			}
		</script>
	</head>
	
	<body>
		<main id="main">
		     <form onsubmit="return wizard_func()">
			<button type="submit" class="btn" id="wizard" name="wizard_btn" >Find service</button>
		     </form>
		     <form onsubmit="return export_func()">
			<button type="submit" class="btn" id="export" name="export_btn">Export</button>
		     </form>
		     <form onsubmit="return get_data_from_database('import')">
			<button type="submit" class="btn" id="import" name="import_btn">Import</button>
		     </form>
		     <form onsubmit="return display_news()">
			<button type="submit" class="btn" id="news_btn" name="news_btn">News</button>
		     </form>
			
			<table class="table" id="myTable">
				<thead>
					<tr>
						<th class="table_head">Name</th>
						<th class="table_head">API Name</th>
						<th class="table_head">Memory</th>
						<th class="table_head">vCPUs</th>
						<th class="table_head">Storage</th>
						<th class="table_head">Today price</th>
						<th class="table_head">Month ago price</th>
						<th class="table_head">Year ago price</th>
						<th class="table_head">Region</th>
						<th class="table_head">Percentage Change Month</th>
						<th class="table_head">Percentage Change Year</th>

					</tr>
				</thead>
				<tbody>
					<!--<tr>
						<td><a>dense compute</a></td>
						<td><a>dc</a></td>
						<td><a>15gib</a></td>
						<td><a>2 vcpus</a></td>
						<td><a>1tb ssd</a></td>
						<td><a>0.5gb/s</a></td>
						<td><a>$1.2 day</a></td>
						<td><a>$1 day</a></td>
					</tr>
					<tr>
						<td><a>managed storage</a></td>
						<td><a>ra3</a></td>
						<td><a>10gib</a></td>
						<td><a>2vcpu</a></td>
						<td><a>0.1tb ssd</a></td>
						<td><a>0.4gb/s</a></td>
						<td><a>$99 day</a></td>
						<td><a>$80 day</a></td>
					</tr>-->
				</tbody>
			</table>
			
			<form class="form" id="wizard_form" onsubmit="return get_data_from_database('wizard')">
				<select class="drop_down" id="regions_names">
						<option value="London">Europe (London)</option> 
						<option value="Paris">Europe (Paris)</option> 
						<option value="Ireland">Europe (Ireland)</option> 
						<option value="Tokyo">Asia-Pacific (Tokyo)</option> 
				</select></br>
				
				<input type="number" class="input_wizard" id="min_price_per_day" placeholder="Min price per day"></br>
				
				<input type="number" class="input_wizard" id="max_price_per_day" placeholder="Max price per day"></br>
				
				<input type="number" class="input_wizard" id="min_memory" placeholder="Min Gib"></br>
				
				<input type="number" class="input_wizard" id="max_memory" placeholder="Max Gib"></br>
				
				<button type="submit" class="wizard_form_btn" id="wizard_find" name="Find">Find</button>
			</form>
			
			<h1>NEWS:</h1>
			<hr>
			
			
			<div id="news">
				<p>sadad</p>
			</div>
		</main>
	</body>
</html>
